import tkinter as tk
from tkinter import filedialog
from tkinter import ttk
import pandas as pd

def select_file():
    file_path = filedialog.askopenfilename(title="Valitse .csv-tiedosto", filetypes=[("CSV files", "*.csv")])
    if not file_path:
        return

    # Lue .csv-tiedosto käyttäen Pandas-kirjastoa
    df = pd.read_csv(file_path)

    # Tarkistetaan, että DataFrame sisältää dataa
    if df.empty:
        print("Tiedosto on tyhjä.")
        return

    # Poista "Valitse .csv-tiedosto" -nappi ja logo
    select_button.pack_forget()
    logo_label.pack_forget()

    # Näytä ensimmäiset 5 riviä .csv-tiedostosta
    data_frame = ttk.Treeview(root)
    data_frame["columns"] = list(df.columns)
    data_frame["show"] = "headings"

    for col in data_frame["columns"]:
        data_frame.heading(col, text=col)

    for index, row in df.head().iterrows():
        data_frame.insert("", "end", values=list(row))

    data_frame.pack(pady=20)

def main():
    global root, logo_label, select_button
    root = tk.Tk()
    root.title("CSV Reader")

    # Luo Frame, johon sijoitetaan logo ja "Valitse .csv-tiedosto" -nappi
    top_frame = tk.Frame(root)
    top_frame.pack()

    # Logo etusivulle
    logo = tk.PhotoImage(file="logomato.png")
    logo_label = tk.Label(top_frame, image=logo)
    logo_label.pack(side=tk.LEFT, padx=20, pady=10)

    select_button = tk.Button(top_frame, text="Valitse .csv-tiedosto", command=select_file)
    select_button.pack(side=tk.LEFT, padx=20, pady=10)

    root.mainloop()

if __name__ == "__main__":
    main()
